import { Animated, StyleSheet } from "react-native";
import { shapeComponent, ShapeComponent } from "set-state-compare/build/shape-component";
import PropTypes from "prop-types";
import React from "react";
import { RowContext } from "./row";
import { TableContext } from "./table";
import useEventEmitter from "ya-use-event-emitter";
import { v4 as uuidv4 } from "uuid";
export default React.memo(shapeComponent(class TableHeader extends ShapeComponent {
    static propTypes = {
        style: PropTypes.oneOfType([PropTypes.array, PropTypes.func, PropTypes.object]),
        width: PropTypes.number
    };
    id = uuidv4();
    position = null;
    setup() {
        const { style } = this.props;
        this.rowContext = React.useContext(RowContext);
        this.tableContext = React.useContext(TableContext);
        this.width = React.useMemo(() => new Animated.Value(this.props.width || 0), []);
        this.style = React.useMemo(() => ({ width: this.tt.width }), []);
        React.useMemo(() => {
            this.headerData = this.tableContext.table.onMountHeader({ header: this });
            this.position = this.headerData.position;
        }, []);
        React.useEffect(() => {
            return () => {
                this.tableContext.table.onUnmountHeader({ header: this });
            };
        }, []);
        React.useLayoutEffect(() => {
            if (typeof style == "function") {
                style({
                    column: this,
                    headerData: this.tt.headerData,
                    rowContext: this.tt.rowContext,
                    style: this.style,
                    tableContext: this.tt.tableContext
                });
            }
            else if (style) {
                Object.assign(this.style, StyleSheet.flatten(style));
            }
        }, [style]);
        useEventEmitter(this.tableContext.events, `column-width-changed-${this.id}`, this.tt.onColumnWidthChanged);
    }
    render() {
        const { children, style, ...restProps } = this.props;
        return (React.createElement(Animated.View, { style: this.tt.style, ...restProps }, children));
    }
    onColumnWidthChanged = ({ width }) => this.tt.width.setValue(width);
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2hlYWRlci5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFFBQVEsRUFBRSxVQUFVLEVBQUMsTUFBTSxjQUFjLENBQUE7QUFDakQsT0FBTyxFQUFDLGNBQWMsRUFBRSxjQUFjLEVBQUMsTUFBTSx5Q0FBeUMsQ0FBQTtBQUN0RixPQUFPLFNBQVMsTUFBTSxZQUFZLENBQUE7QUFDbEMsT0FBTyxLQUFLLE1BQU0sT0FBTyxDQUFBO0FBQ3pCLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxPQUFPLENBQUE7QUFDaEMsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFNBQVMsQ0FBQTtBQUNwQyxPQUFPLGVBQWUsTUFBTSxzQkFBc0IsQ0FBQTtBQUNsRCxPQUFPLEVBQUMsRUFBRSxJQUFJLE1BQU0sRUFBQyxNQUFNLE1BQU0sQ0FBQTtBQUVqQyxlQUFlLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sV0FBWSxTQUFRLGNBQWM7SUFDL0UsTUFBTSxDQUFDLFNBQVMsR0FBRztRQUNqQixLQUFLLEVBQUUsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDL0UsS0FBSyxFQUFFLFNBQVMsQ0FBQyxNQUFNO0tBQ3hCLENBQUE7SUFFRCxFQUFFLEdBQUcsTUFBTSxFQUFFLENBQUE7SUFDYixRQUFRLEdBQUcsSUFBSSxDQUFBO0lBRWYsS0FBSztRQUNILE1BQU0sRUFBQyxLQUFLLEVBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFBO1FBRTFCLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQTtRQUM5QyxJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUE7UUFDbEQsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQTtRQUMvRSxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUE7UUFFOUQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUU7WUFDakIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQTtZQUN2RSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFBO1FBQzFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQTtRQUVOLEtBQUssQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFO1lBQ25CLE9BQU8sR0FBRyxFQUFFO2dCQUNWLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFBO1lBQ3pELENBQUMsQ0FBQTtRQUNILENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQTtRQUVOLEtBQUssQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFFO1lBQ3pCLElBQUksT0FBTyxLQUFLLElBQUksVUFBVSxFQUFFLENBQUM7Z0JBQy9CLEtBQUssQ0FBQztvQkFDSixNQUFNLEVBQUUsSUFBSTtvQkFDWixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVO29CQUM5QixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVO29CQUM5QixLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7b0JBQ2pCLFlBQVksRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVk7aUJBQ25DLENBQUMsQ0FBQTtZQUNKLENBQUM7aUJBQU0sSUFBSSxLQUFLLEVBQUUsQ0FBQztnQkFDakIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQTtZQUN0RCxDQUFDO1FBQ0gsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQTtRQUVYLGVBQWUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSx3QkFBd0IsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsb0JBQW9CLENBQUMsQ0FBQTtJQUM1RyxDQUFDO0lBRUQsTUFBTTtRQUNKLE1BQU0sRUFBQyxRQUFRLEVBQUUsS0FBSyxFQUFFLEdBQUcsU0FBUyxFQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQTtRQUVsRCxPQUFPLENBQ0wsb0JBQUMsUUFBUSxDQUFDLElBQUksSUFBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEtBQU0sU0FBUyxJQUMvQyxRQUFRLENBQ0ssQ0FDakIsQ0FBQTtJQUNILENBQUM7SUFFRCxvQkFBb0IsR0FBRyxDQUFDLEVBQUMsS0FBSyxFQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtDQUNsRSxDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QW5pbWF0ZWQsIFN0eWxlU2hlZXR9IGZyb20gXCJyZWFjdC1uYXRpdmVcIlxuaW1wb3J0IHtzaGFwZUNvbXBvbmVudCwgU2hhcGVDb21wb25lbnR9IGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9zaGFwZS1jb21wb25lbnRcIlxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiXG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCJcbmltcG9ydCB7Um93Q29udGV4dH0gZnJvbSBcIi4vcm93XCJcbmltcG9ydCB7VGFibGVDb250ZXh0fSBmcm9tIFwiLi90YWJsZVwiXG5pbXBvcnQgdXNlRXZlbnRFbWl0dGVyIGZyb20gXCJ5YS11c2UtZXZlbnQtZW1pdHRlclwiXG5pbXBvcnQge3Y0IGFzIHV1aWR2NH0gZnJvbSBcInV1aWRcIlxuXG5leHBvcnQgZGVmYXVsdCBSZWFjdC5tZW1vKHNoYXBlQ29tcG9uZW50KGNsYXNzIFRhYmxlSGVhZGVyIGV4dGVuZHMgU2hhcGVDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIHN0eWxlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYXJyYXksIFByb3BUeXBlcy5mdW5jLCBQcm9wVHlwZXMub2JqZWN0XSksXG4gICAgd2lkdGg6IFByb3BUeXBlcy5udW1iZXJcbiAgfVxuXG4gIGlkID0gdXVpZHY0KClcbiAgcG9zaXRpb24gPSBudWxsXG5cbiAgc2V0dXAoKSB7XG4gICAgY29uc3Qge3N0eWxlfSA9IHRoaXMucHJvcHNcblxuICAgIHRoaXMucm93Q29udGV4dCA9IFJlYWN0LnVzZUNvbnRleHQoUm93Q29udGV4dClcbiAgICB0aGlzLnRhYmxlQ29udGV4dCA9IFJlYWN0LnVzZUNvbnRleHQoVGFibGVDb250ZXh0KVxuICAgIHRoaXMud2lkdGggPSBSZWFjdC51c2VNZW1vKCgpID0+IG5ldyBBbmltYXRlZC5WYWx1ZSh0aGlzLnByb3BzLndpZHRoIHx8IDApLCBbXSlcbiAgICB0aGlzLnN0eWxlID0gUmVhY3QudXNlTWVtbygoKSA9PiAoe3dpZHRoOiB0aGlzLnR0LndpZHRofSksIFtdKVxuXG4gICAgUmVhY3QudXNlTWVtbygoKSA9PiB7XG4gICAgICB0aGlzLmhlYWRlckRhdGEgPSB0aGlzLnRhYmxlQ29udGV4dC50YWJsZS5vbk1vdW50SGVhZGVyKHtoZWFkZXI6IHRoaXN9KVxuICAgICAgdGhpcy5wb3NpdGlvbiA9IHRoaXMuaGVhZGVyRGF0YS5wb3NpdGlvblxuICAgIH0sIFtdKVxuXG4gICAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIHRoaXMudGFibGVDb250ZXh0LnRhYmxlLm9uVW5tb3VudEhlYWRlcih7aGVhZGVyOiB0aGlzfSlcbiAgICAgIH1cbiAgICB9LCBbXSlcblxuICAgIFJlYWN0LnVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgICBpZiAodHlwZW9mIHN0eWxlID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgY29sdW1uOiB0aGlzLFxuICAgICAgICAgIGhlYWRlckRhdGE6IHRoaXMudHQuaGVhZGVyRGF0YSxcbiAgICAgICAgICByb3dDb250ZXh0OiB0aGlzLnR0LnJvd0NvbnRleHQsXG4gICAgICAgICAgc3R5bGU6IHRoaXMuc3R5bGUsXG4gICAgICAgICAgdGFibGVDb250ZXh0OiB0aGlzLnR0LnRhYmxlQ29udGV4dFxuICAgICAgICB9KVxuICAgICAgfSBlbHNlIGlmIChzdHlsZSkge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuc3R5bGUsIFN0eWxlU2hlZXQuZmxhdHRlbihzdHlsZSkpXG4gICAgICB9XG4gICAgfSwgW3N0eWxlXSlcblxuICAgIHVzZUV2ZW50RW1pdHRlcih0aGlzLnRhYmxlQ29udGV4dC5ldmVudHMsIGBjb2x1bW4td2lkdGgtY2hhbmdlZC0ke3RoaXMuaWR9YCwgdGhpcy50dC5vbkNvbHVtbldpZHRoQ2hhbmdlZClcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7Y2hpbGRyZW4sIHN0eWxlLCAuLi5yZXN0UHJvcHN9ID0gdGhpcy5wcm9wc1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxBbmltYXRlZC5WaWV3IHN0eWxlPXt0aGlzLnR0LnN0eWxlfSB7Li4ucmVzdFByb3BzfT5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC9BbmltYXRlZC5WaWV3PlxuICAgIClcbiAgfVxuXG4gIG9uQ29sdW1uV2lkdGhDaGFuZ2VkID0gKHt3aWR0aH0pID0+IHRoaXMudHQud2lkdGguc2V0VmFsdWUod2lkdGgpXG59KSlcbiJdfQ==